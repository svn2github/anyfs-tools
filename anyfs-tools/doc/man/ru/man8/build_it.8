.TH build_it 8 "27 July 2007" "Version 0.84.12"
.SH "НАЗВАНИЕ"
build_it \- считывает информацию о расположении информационных узлов и \
правах доступа и сохраняет её в файл внешней таблицы инф.узлов.
.SH "СИНТАКСИС"
.BI "build_it [\-qvVnsafp] " "directory inode_table"

.SH "ОПИСАНИЕ"

.B build_it 
считывает из директории рекурсивно информацию обо всех \
инф.узлах файловой системы используя драйвер (для чтения) ОС 
.B Linux
и сохраняет её в виде внешней таблицы инф.узлов.

Для работы утилита требует наличия драйвера файловой системы \
(возможно только для чтения) для ОС 
.B Linux
с поддержкой системного вызова
.BR ioctl (2)
.BR FIBMAP .
Вызов
.B FIBMAP
требует наличия у пользователя прав
.BR суперпользователя .
Начиная с версии 0.84.9 утилита воспользуется эффективным идентификатором \
если на файле установлен SUID бит, чтобы произвести эти операции. \
Так запуск программы становится возможным и от обычного пользователя.

Работа утилиты протестирована на файловых системах:
.BR EXT2FS/EXT3FS , " XFS" , " ReiserFS" , " VFAT" , " JFS" , " ISO9660" , " ntfs-3g" .

Большинство из них (кроме
.BR NTFS )
имеют полноценную поддержку
.BR FIBMAP .

В драйвере файловой системы
.B NTFS
поддержка
.B FIBMAP
присутствует в FUSE драйвере
.BR ntfs-3g
начиная с версии 0.20061212-BETA. \
При этом вам необходимо смонтировать файловую систему с опцией 
.BR blkdev .
Читайте 
.BR losetup(8) , 
если вам необходимо таким образом смонтировать \
образ ФС, а не блочное устройство.

Имейте также в виду, что все достаточно малые файлы в 
.B NTFS 
хранятся \
в упакованном формате и они будут отображены в таблице инф.узлов \
как sparse-файлы. Так же sparse-файлами будут отображены все шифрованные/ \
сжатые файлы на уровне файловой системы. \
Смотрите описание опции 
.BR \-s .

Для
.BR ReiserFS "(и " Reiser4 )
.B build_it
будет вызывать ioctl вызов UNPACK, чтобы избежать tail-packing'а \
и получить правильную карту его файлов.

Вы можете использовать опцию
.B -n
если не хотите изменений на файловой системе (что может быть важно при \
восстановлении данных), но в этом случае вы можете получить не совсем \
верную таблицу инф.узлов.

.SH "ОПЦИИ"
.TP
.B \-q
Не выводить ни каких сообщений.
.TP
.B \-v
Выводить некоторую дополнительную информацию.
.TP
.B \-V
Вывести только номер версии и выйти.
.TP
.B \-n
Не распаковывать файлы ReiserFS и Reiser4FS.
.TP
.B \-s
Выводить на стандартный поток вывода список всех sparse-файлов. \
Используется утилитой 
.BR anyconvertfs(8) 
для формирования rescue-списка при конвертировании из 
.BR ntfs-3g .
.TP
.B \-a
Использовать абсолютную адресацию относительно всего диска, а не \
его отдельного раздела. Имейте ввиду при использовании этой опции \
что далее для монтирования полученной таблицы инф.узлов необходимо \
указывать целый диск (например /dev/hda), а не отдельный его раздел \
(например /dev/hda1, /dev/hdb7). Кроме того это означает автоматическую
установку размера блока таблицы инф.узлов в размер сектора (512 байт),
т.к. именно в секторах задаётся смещение разделов в таблице разделов.
.TP
.B \-f
Обходить другие файловые системы расположенные на разделах \
того же устройства, что и файловая система указанной директории. \
Так если /dev/hda1 смонтирован в /mnt/root, /dev/hda3 в /mnt/root/home, \
а /dev/hdb1 в /mnt/root/usr, то при указании утилите директории /mnt/root, \
в таблицу инф.узлов будет включено также всё содержимое /mnt/home, \
но содержимое /mnt/usr по-прежнему не будет включено в неё. \
Опция может быть использована только одновременно с
.BR \-a .
.B \-p
Создать в таблице инф.узлов также все директории от корня до \
указанной директории.
.TP
.I directory
Директория, обычно корень/точка монтирования файловой системы, построение \
таблицы инф.узлов которой будет производится.
.TP
.I inode_table
Файл, в который будет сохранена внешняя таблица инф.узлов.

.SH "ПРИМЕРЫ ИСПОЛЬЗОВАНИЯ"
Построение внешней таблицы инф.узлов файловой системы на устройстве \
смонтированной в домашней директории пользователя user:
.br
# build_it /home/user /tmp/inode.table

Замечание: будет лучше, если будущая таблица инф. узлов будет располагаться \
на другом устройстве (или директории расположенной вне рекурсивной обработки \
дерева), как и в примере.

Замечание: если точка монтирования в этом примере /home (не /home/user) \
то построенная внешняя таблица инф.узлов не будет включать файлов из \
других директорий, чем /home/user -- это будет частичная таблица инф.узлов \
устройства.

Замечание: если там будет другая точка монтирования в рекурсивно обрабатываемом \
дереве (например /home/user/mount/point) -- она не будет обработана \
(таблица инф.узлов не может содержать информации о нескольких различных \
 устройствах)

.SH "АВТОР"
Николай Кривченков aka unDEFER <undefer@gmail.com>

.SH "СООБЩЕНИЯ ОБ ОШИБКАХ"
Сообщения о любых проблемах с применением пакета
.B anyfs-tools
направляйте по адресу:
undefer@gmail.com

.SH "ДОСТУПНОСТЬ"
последнюю версию пакета вы можете получить на сайте проекта: \
http://anyfs-tools.sourceforge.net

.SH "СМ. ТАКЖЕ"
.BR anyfs-tools(8),
.BR ioctl(2),
.BR ioctl_list(2) ,
.BR anyfs_inode_table(5)
